### MANAGED BY PUPPET ###

##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# http://wiki.nginx.org/Pitfalls
# http://wiki.nginx.org/QuickStart
# http://wiki.nginx.org/Configuration
#
# Generally, you will want to move this file somewhere, and start with a clean
# file but keep this around for reference. Or just disable in sites-enabled.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
        listen 80 ;
        listen [::]:80;

        # SSL configuration
        #
        # listen 443 ssl default_server;
        # listen [::]:443 ssl default_server;
        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root <%= @document_root %>;

        # Add index.php to the list if you are using PHP
        #index index.html index.htm index.nginx-debian.html;

        server_name <%= @nginx_server_name %> <%= @nginx_server_alias %>;

        index index.php index.html index.htm;

        access_log <%= @access_log %>;
        error_log <%= @error_log%>;


        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ /index.php?$query_string;
        }

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        <%- if @fastcgi -%>
        location ~ \.php$ {

                fastcgi_pass <%= @fastcgi %>;
                fastcgi_index  index.php;
                fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
                <%- if @fastcgi_read_timeout -%>
                fastcgi_read_timeout <%=@fastcgi_read_timeout%>;
                <%- end -%>

                include        fastcgi_params;


        }
        <%- end -%>

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        location ~ /\.ht {
               deny all;
        }

        <%- if @absolute_redirect -%>
            absolute_redirect <%= @absolute_redirect %>;
        <%- end -%>
        <%- if @aio -%>
            aio <%= @aio %>;
        <%- end -%>
        <%- if @aio_write -%>
            aio_write <%= @aio_write %>;
        <%- end -%>
        <%- if @chunked_transfer_encoding -%>
            chunked_transfer_encoding <%= @chunked_transfer_encoding %>;
        <%- end -%>
        <%- if @client_body_buffer_size -%>
            client_body_buffer_size <%= @client_body_buffer_size %>;
        <%- end -%>
        <%- if @client_body_in_file_only -%>
            client_body_in_file_only <%= @client_body_in_file_only %>;
        <%- end -%>
        <%- if @client_body_in_single_buffer -%>
            client_body_in_single_buffer <%= @client_body_in_single_buffer %>;
        <%- end -%>
        <%- if @client_body_temp_path -%>
            client_body_temp_path <%= @client_body_temp_path %>;
        <%- end -%>
        <%- if @client_body_timeout -%>
            client_body_timeout <%= @client_body_timeout %>;
        <%- end -%>
        <%- if @client_header_buffer_size -%>
            client_header_buffer_size <%= @client_header_buffer_size %>;
        <%- end -%>
        <%- if @client_header_timeout -%>
            client_header_timeout <%= @client_header_timeout %>;
        <%- end -%>
        <%- if @client_max_body_size -%>
            client_max_body_size <%= @client_max_body_size %>;
        <%- end -%>
        <%- if @connection_pool_size -%>
            connection_pool_size <%= @connection_pool_size %>;
        <%- end -%>
        <%- if @default_type -%>
            default_type <%= @default_type %>;
        <%- end -%>
        <%- if @directio -%>
            directio <%= @directio %>;
        <%- end -%>
        <%- if @directio_alignment -%>
            directio_alignment <%= @directio_alignment %>;
        <%- end -%>
        <%- if @disable_symlinks -%>
            disable_symlinks <%= @disable_symlinks %>;
        <%- end -%>
        <%- if @etag -%>
            etag <%= @etag %>;
        <%- end -%>
        <%- if @if_modified_since -%>
            if_modified_since <%= @if_modified_since %>;
        <%- end -%>
        <%- if @ignore_invalid_headers -%>
            ignore_invalid_headers <%= @ignore_invalid_headers %>;
        <%- end -%>
        <%- if @keepalive_disable -%>
            keepalive_disable <%= @keepalive_disable %>;
        <%- end -%>
        <%- if @keepalive_requests -%>
            keepalive_requests <%= @keepalive_requests %>;
        <%- end -%>
        <%- if @keepalive_timeout -%>
            keepalive_timeout <%= @keepalive_timeout %>;
        <%- end -%>
        <%- if @large_client_header_buffers -%>
            large_client_header_buffers <%= @large_client_header_buffers %>;
        <%- end -%>
        <%- if @limit_rate -%>
            limit_rate <%= @limit_rate %>;
        <%- end -%>
        <%- if @limit_rate_after -%>
            limit_rate_after <%= @limit_rate_after %>;
        <%- end -%>
        <%- if @lingering_close -%>
            lingering_close <%= @lingering_close %>;
        <%- end -%>
        <%- if @lingering_time -%>
            lingering_time <%= @lingering_time %>;
        <%- end -%>
        <%- if @lingering_timeout -%>
            lingering_timeout <%= @lingering_timeout %>;
        <%- end -%>
        <%- if @listen -%>
            listen <%= @listen %>;
        <%- end -%>
        <%- if @log_not_found -%>
            log_not_found <%= @log_not_found %>;
        <%- end -%>
        <%- if @log_subrequest -%>
            log_subrequest <%= @log_subrequest %>;
        <%- end -%>
        <%- if @merge_slashes -%>
            merge_slashes <%= @merge_slashes %>;
        <%- end -%>
        <%- if @msie_padding -%>
            msie_padding <%= @msie_padding %>;
        <%- end -%>
        <%- if @msie_refresh -%>
            msie_refresh <%= @msie_refresh %>;
        <%- end -%>
        <%- if @open_file_cache -%>
            open_file_cache <%= @open_file_cache %>;
        <%- end -%>
        <%- if @open_file_cache_errors -%>
            open_file_cache_errors <%= @open_file_cache_errors %>;
        <%- end -%>
        <%- if @open_file_cache_min_uses -%>
            open_file_cache_min_uses <%= @open_file_cache_min_uses %>;
        <%- end -%>
        <%- if @open_file_cache_valid -%>
            open_file_cache_valid <%= @open_file_cache_valid %>;
        <%- end -%>
        <%- if @output_buffers -%>
            output_buffers <%= @output_buffers %>;
        <%- end -%>
        <%- if @port_in_redirect -%>
            port_in_redirect <%= @port_in_redirect %>;
        <%- end -%>
        <%- if @postpone_output -%>
            postpone_output <%= @postpone_output %>;
        <%- end -%>
        <%- if @read_ahead -%>
            read_ahead <%= @read_ahead %>;
        <%- end -%>
        <%- if @recursive_error_pages -%>
            recursive_error_pages <%= @recursive_error_pages %>;
        <%- end -%>
        <%- if @request_pool_size -%>
            request_pool_size <%= @request_pool_size %>;
        <%- end -%>
        <%- if @reset_timedout_connection -%>
            reset_timedout_connection <%= @reset_timedout_connection %>;
        <%- end -%>
        <%- if @resolver_timeout -%>
            resolver_timeout <%= @resolver_timeout %>;
        <%- end -%>
        <%- if @root -%>
            root <%= @root %>;
        <%- end -%>
        <%- if @satisfy -%>
            satisfy <%= @satisfy %>;
        <%- end -%>
        <%- if @send_lowat -%>
            send_lowat <%= @send_lowat %>;
        <%- end -%>
        <%- if @send_timeout -%>
            send_timeout <%= @send_timeout %>;
        <%- end -%>
        <%- if @sendfile -%>
            sendfile <%= @sendfile %>;
        <%- end -%>
        <%- if @sendfile_max_chunk -%>
            sendfile_max_chunk <%= @sendfile_max_chunk %>;
        <%- end -%>
        <%- if @server_tokens -%>
            server_tokens <%= @server_tokens %>;
        <%- end -%>
        <%- if @tcp_nodelay -%>
            tcp_nodelay <%= @tcp_nodelay %>;
        <%- end -%>
        <%- if @tcp_nopush -%>
            tcp_nopush <%= @tcp_nopush %>;
        <%- end -%>
        <%- if @types_hash_bucket_size -%>
            types_hash_bucket_size <%= @types_hash_bucket_size %>;
        <%- end -%>
        <%- if @types_hash_max_size -%>
            types_hash_max_size <%= @types_hash_max_size %>;
        <%- end -%>
        <%- if @underscores_in_headers -%>
            underscores_in_headers <%= @underscores_in_headers %>;
        <%- end -%>
}


